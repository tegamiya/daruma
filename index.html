<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>担々麺だるま｜公式サイト</title>
  <meta name="description" content="担々麺だるまの公式サイト。赤の担々麺・黒の担々麺、辛さ1/2〜5をお好みで。福岡県大野城市下大利1-15-14。営業時間 11:00〜14:30 / 17:00〜23:30。" />
  <link rel="canonical" href="https://your-name.github.io/your-repo/" />
  <meta property="og:title" content="担々麺だるま｜公式サイト" />
  <meta property="og:description" content="香り立つ胡麻と花椒。赤と黒の担々麺、辛さ1/2〜5をお好みで。福岡県大野城市下大利1-15-14。営業時間 11:00〜14:30 / 17:00〜23:30。" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://images.unsplash.com/photo-1617093727343-374698792f0b?q=80&w=1200&auto=format&fit=crop" />
  <meta property="og:locale" content="ja_JP" />
  <meta property="og:site_name" content="担々麺だるま" />
  <meta name="format-detection" content="telephone=no" />
  <!-- 検索回避 -->
  <meta name="robots" content="noindex, nofollow">
  <meta name="theme-color" content="#0b0b0b" />

  <!-- サイト全体CSS -->
  <link rel="stylesheet" href="css/styles.css">

  <!-- 構造化データ -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Restaurant",
    "name": "担々麺だるま",
    "servesCuisine": "Chinese",
    "address": {"@type": "PostalAddress", "addressLocality": "福岡県大野城市", "streetAddress": "下大利1-15-14", "postalCode": "816-0952"},
    "url": "https://your-name.github.io/your-repo/",
    "priceRange": "\\",
    "image": [
      "https://images.unsplash.com/photo-1617093727343-374698792f0b?q=80&w=1200&auto=format&fit=crop"
    ]
  }
  </script>
</head>
<body>
  <!-- Soft Gate -->
  <div id="gate" class="gate hidden" aria-modal="true" role="dialog" aria-labelledby="gateTitle" aria-describedby="gateDesc">
    <span id="gateTitle" class="sr-only">閲覧パスワード</span>
    <span id="gateDesc" class="sr-only">一時的に閲覧制限をしています。</span>
    <form id="gateForm" class="panel" autocomplete="off">
      <h3 style="margin:0 0 .5rem">閲覧パスワード</h3>
      <p class="muted" style="margin:0 0 .8rem">一時的に閲覧制限をしています。</p>
      <label for="pw" class="muted">パスワード</label>
      <input type="password" id="pw" required>
      <button class="btn btn-primary" type="submit" style="width:100%;margin-top:.8rem">送信</button>
    </form>
  </div>

  <div class="accent-bar" aria-hidden="true"></div>
  <div id="progress"></div>
  <a href="#main" class="pill skip-link">メインへスキップ</a>

  <!-- Header / Navigation -->
  <header>
    <div class="container nav">
      <div class="brand">
        <img class="logo" src="img/daruma.png" alt="" aria-hidden="true" width="34" height="34" loading="lazy" decoding="async" />
        <h1><a href="#main" class="home-link" aria-label="トップへ戻る">担々麺だるま</a></h1>
      </div>
      <nav aria-label="グローバルメニュー">
        <div class="links">
          <a href="#about">お店について</a>
          <a href="#menu">メニュー</a>
          <a href="#photos">写真</a>
          <a href="#contact">お問い合わせ</a>
        </div>
        <details role="list">
          <summary aria-label="メニュー">☰ メニュー</summary>
          <div class="menu" onClick="this.parentElement.removeAttribute('open')">
            <a href="#about">お店について</a>
            <a href="#menu">メニュー</a>
            <a href="#photos">写真</a>
            <a href="#contact">お問い合わせ</a>
          </div>
        </details>
      </nav>
    </div>
  </header>

  <div class="marquee" aria-label="お知らせ">
    <div class="track">辛さ1/2〜5まで調整OK ｜ 福岡県大野城市下大利1-15-14 ｜ 営業 11:00〜14:30 / 17:00〜23:30 ｜ Instagram @tantanmendaruma</div>
  </div>

  <!-- Hero -->
  <main id="main" tabindex="-1">
  <section class="hero">
    <div class="container hero-grid">
      <div>
        <span class="pill badge">福岡・大野城の担々麺</span>
        <h2 class="title">香る胡麻と刺激ある辛味。赤と黒、好みで選べる担々麺。</h2>
      <div class="cta">
        <a class="btn btn-primary" href="#menu">メニューをみる</a>
        <a class="btn btn-outline" href="#access">アクセスを見る</a>
      </div>
    </div>
      <div>
        <img class="kv" src="img/tantanmen.jpg" alt="香り高い担々麺の写真" fetchpriority="high" decoding="async" width="1600" height="900" srcset="img/tantanmen-w400.jpg 400w, img/tantanmen-w800.jpg 800w, img/tantanmen-w1200.jpg 1200w, img/tantanmen-w1600.jpg 1600w" sizes="(min-width: 1200px) 700px, (min-width: 900px) 600px, 100vw" />
      </div>
    </div>
  </section>

  <div class="wave" aria-hidden="true">
    <svg viewBox="0 0 1440 120" preserveAspectRatio="none" aria-hidden="true">
      <path d="M0,40 C240,120 480,0 720,60 C960,120 1200,40 1440,80 L1440,120 L0,120 Z"></path>
    </svg>
  </div>

  <!-- About -->
  <section id="about">
    <div class="container info-grid">
      <div class="card">
        <h2>お店について</h2>
        <ul>
          <li>住所：<strong>福岡県大野城市下大利1-15-14</strong></li>
          <li>営業時間：<strong>11:00〜14:30 / 17:00〜23:30（全日）</strong></li>
          <li>定休日：<strong>不定休</strong>（最新情報はInstagramをご確認ください）</li>
          <li>座席：<strong>18席（カウンター10席／テーブル8席）</strong></li>
          <li>喫煙：<strong>全席禁煙</strong></li>
          <li>駐車場：<strong>1台分あり。近隣にコインパーキングあり</strong></li>
          <li>決済：<strong>現金・PayPay（カード／電子マネー不可）</strong></li>
          <li>予約：<strong>予約不可</strong></li>
        </ul>
      <div class="contact-actions">
          <a class="btn btn-primary" href="https://www.instagram.com/tantanmendaruma/" target="_blank" rel="noopener">Instagramを見る</a>
          <button class="btn btn-primary" id="loadMap" type="button">地図を開く（Googleマップ）</button>
        </div>
      <div class="map-placeholder" id="mapbox" data-src="https://maps.google.com/maps?q=%E7%A6%8F%E5%B2%A1%E7%9C%8C%E5%A4%A7%E9%87%8E%E5%9F%8E%E5%B8%82%E4%B8%8B%E5%A4%A7%E5%88%A91-15-14&t=&z=17&ie=UTF8&iwloc=&output=embed"></div>

      </div>
      <div class="card">
        <h2>こだわり</h2>
        <p class="lead">赤の担々麺・黒の担々麺を中心に、辛さは<strong>1/2〜5</strong>から調整OK。ご要望があればそれ以上もご相談ください。菜の花や肉みそトッピング、オリジナルクラフトビールもご用意。西鉄下大利駅から徒歩1分です。</p>
        <ul>
          <li>辛さ：<span class="pill">1/2〜5</span>（希望でさらに調整可）</li>
          <li>麺：特製ストレート麺</li>
          <li>トッピング：菜の花、肉みそ、温玉 など</li>
          <li>ドリンク：オリジナルクラフトビールあり</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Menu -->
    <section id="menu">
    <div class="container">
      <h2>メニュー</h2>
      <p class="lead">写真内にメニュー名と価格を記載しています。タップ（クリック）で拡大してご覧ください。</p>

      <div class="menu-photo-grid" aria-label="メニュー写真一覧">
        <figure class="menu-photo">
          <img src="img/aka.jpg" alt="赤の担々麺の写真" loading="lazy" decoding="async">
          <figcaption>赤の担々麺</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/kuro.jpg" alt="黒の担々麺の写真" loading="lazy" decoding="async">
          <figcaption>黒の担々麺</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/nanohana.jpg" alt="菜の花ラーメンの写真" loading="lazy" decoding="async">
          <figcaption>菜の花ラーメン</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/omuraisu.jpg" alt="ふわトロオムライスの写真" loading="lazy" decoding="async">
          <figcaption>ふわトロオムライス</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/topping.jpg" alt="トッピングメニューの写真" loading="lazy" decoding="async">
          <figcaption>トッピングメニュー</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/karami.jpg" alt="辛味表の写真" loading="lazy" decoding="async">
          <figcaption>辛味表</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/gohan.jpg" alt="セットメニューの写真" loading="lazy" decoding="async">
          <figcaption>セットメニュー</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/oomori.jpg" alt="その他メニューの写真" loading="lazy" decoding="async">
          <figcaption>その他メニュー</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/alcol.jpg" alt="アルコールメニューの写真" loading="lazy" decoding="async">
          <figcaption>アルコールメニュー</figcaption>
        </figure>
        <figure class="menu-photo">
          <img src="img/soft.jpg" alt="ソフトドリンクメニューの写真" loading="lazy" decoding="async">
          <figcaption>ソフトドリンクメニュー</figcaption>
        </figure>
      </div>

    </div>
  </section>

  <!-- Photos -->
  <section id="photos">
    <div class="container">
      <h2>写真</h2>
      <p class="lead">店内・外観の雰囲気をご覧ください。</p>
      <div class="photo-grid">
        <img src="img/naisou.jpg" alt="店内カウンター席" loading="lazy" height="600" srcset="img/naisou-w400.jpg 400w, img/naisou-w800.jpg 800w, img/naisou-w1200.jpg 1200w" sizes="(min-width: 1200px) 20vw, (min-width: 900px) 25vw, (min-width: 600px) 33vw, 50vw"/>
        <img src="img/gaikan.jpg" alt="店舗外観" loading="lazy" height="600" srcset="img/gaikan-w400.jpg 400w, img/gaikan-w800.jpg 800w, img/gaikan-w1200.jpg 1200w" sizes="(min-width: 1200px) 20vw, (min-width: 900px) 25vw, (min-width: 600px) 33vw, 50vw"/>
      </div>
    </div>
  </section>

  <!-- Access -->
  <section id="access" aria-label="アクセス情報"></section>

  <!-- Contact -->
  <section id="contact">
    <div class="container">
      <h2>お問い合わせ</h2>
      <p class="lead">ご予約は承っておりません。お問い合わせは <strong>InstagramのDM</strong> またはスタッフまでお声がけください。</p>
      <div class="card">
        <p>Instagram：<a href="https://www.instagram.com/tantanmendaruma/" target="_blank" rel="noopener">@tantanmendaruma</a></p>
      </div>
    </div>
  </section>

  </main>
  <footer>
    <div class="container">
      <p>© <span id="y"></span> 担々麺だるま - All rights reserved.</p>
      <p><a href="#main" aria-label="ページ先頭へ戻る">↑ 先頭へ戻る</a></p>
    </div>
  </footer>

  <!-- UI extras -->
  <button id="toTop" class="toTop" aria-label="先頭へ戻る">↑</button>
  <dialog id="lightbox">
    <div class="lightbox-backdrop"></div>
    <img id="lightboxImg" class="lightbox-img" alt="">
    <button id="lightboxClose" class="lightbox-close" type="button" aria-label="閉じる" title="閉じる">×</button>
  </dialog>

  <script>
  // 年を自動表示
  document.getElementById('y').textContent = new Date().getFullYear();

  // アニメーション（IntersectionObserver）
  const io = new IntersectionObserver((entries, obs)=>{
    entries.forEach(e=>{
      if(e.isIntersecting){
        e.target.classList.add('reveal-in');
        obs.unobserve(e.target);
      }
    });
  },{ threshold: 0.15 });
  document.querySelectorAll('.card, .menu-item, .photo-grid img, .kv, .cta .btn, h2')
    .forEach(el=>{ el.classList.add('reveal-base'); io.observe(el); });

  // スクロールでヘッダーを縮める
  const hdr = document.querySelector('header');
  const onScroll = ()=>{ if(window.scrollY>8) hdr.classList.add('scrolled'); else hdr.classList.remove('scrolled'); };
  onScroll();
  addEventListener('scroll', onScroll, {passive:true});

  // ナビのリンクをスムーズスクロール
  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener('click', e=>{
      const hash = a.getAttribute('href');
      if(!hash || hash === '#') return;
      const target = document.querySelector(hash);
      if(!target) return;
      e.preventDefault();
      target.scrollIntoView({behavior:'smooth', block:'start'});
      const openMenu = document.querySelector('details[role="list"][open]');
      if(openMenu) openMenu.removeAttribute('open');
      history.replaceState(null, '', hash);
    });
  });

  // クリックで地図を読込（ユーザー操作時のみ外部接続）
  const mapbox = document.getElementById('mapbox');
  const loadBtn = document.getElementById('loadMap');
  if(mapbox && loadBtn){
    loadBtn.addEventListener('click', ()=>{
      const url = mapbox.getAttribute('data-src');
      const iframe = document.createElement('iframe');
      iframe.className = 'map';
      iframe.loading = 'lazy';
      iframe.setAttribute('allowfullscreen','');
      iframe.src = url;
      mapbox.replaceWith(iframe);
    });
  }

  // Scrollspy（現在位置をナビに反映）
  {
    const ids = ["about","menu","photos","access","contact"];
    const sections = ids.map(id=>document.getElementById(id)).filter(Boolean);
    const linkMap = new Map([...document.querySelectorAll('nav a[href^="#"]')].map(a=>[a.getAttribute('href').slice(1), a]));
    const spy = new IntersectionObserver(entries=>{
      entries.forEach(e=>{
        if(!e.isIntersecting) return;
        const id = e.target.id;
        linkMap.forEach(a=>{ a.classList.remove('active'); a.removeAttribute('aria-current'); });
        const link = linkMap.get(id);
        if(link){ link.classList.add('active'); link.setAttribute('aria-current','page'); }
      });
    },{ rootMargin:"-45% 0px -50% 0px", threshold:0.01 });
    sections.forEach(sec=>spy.observe(sec));
  }

  // ライトボックス（写真拡大）
  {
    const dlg = document.getElementById('lightbox');
    const dlgImg = document.getElementById('lightboxImg');
    const dlgClose = document.getElementById('lightboxClose');
    if(dlg && dlgImg){
      document.querySelectorAll('#photos .photo-grid img, .menu-photo-grid img').forEach(img=>{
        img.addEventListener('click', ()=>{ dlgImg.src = img.src; dlgImg.alt = img.alt||""; dlg.showModal(); if(dlgClose){ dlgClose.focus(); } });
      });
      dlg.addEventListener('click', (e)=>{ if(e.target !== dlgImg) dlg.close(); });
      if(dlgClose){ dlgClose.addEventListener('click', (e)=>{ e.stopPropagation(); dlg.close(); }); }
      addEventListener('keydown', (e)=>{ if(e.key==='Escape' && dlg.open) dlg.close(); });
    }
  }

  // ページトップボタンとプログレスバー
  {
    const prefersReduce = matchMedia('(prefers-reduced-motion: reduce)').matches;
    const toTop = document.getElementById('toTop');
    const progress = document.getElementById('progress');
    const heroImg = document.querySelector('.kv');
    const update = ()=>{
      const doc = document.documentElement;
      const scrolled = doc.scrollTop || window.pageYOffset;
      const height = doc.scrollHeight - doc.clientHeight;
      if(progress){ const ratio = height>0 ? scrolled/height : 0; progress.style.width = (ratio*100)+'%'; }
      if(toTop){ const show = scrolled > 600; toTop.style.opacity = show?1:0; toTop.style.pointerEvents = show?'auto':'none'; }
      if(heroImg && !prefersReduce){ const y = Math.min(20, scrolled*0.05); heroImg.style.transform = `translateY(${y}px)`; }
    };
    update();
    addEventListener('scroll', update, {passive:true});
    if(toTop){ toTop.addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'})); }
  }

  // 画像のBlur-up
  {
    const imgs = [
      ...document.querySelectorAll('.kv, #photos .photo-grid img, .menu-photo-grid img')
    ];
    imgs.forEach(img=>{
      img.classList.add('blur-up');
      if(img.complete){ img.classList.add('loaded'); }
      else { img.addEventListener('load', ()=> img.classList.add('loaded')); }
    });
  }

  // toggleFlashボタンがあれば除去
  {
    const btn = document.getElementById('toggleFlash');
    if(btn) btn.remove();
  }
  </script>
  <script>
  /* --- Soft Gate (閲覧パスワード) --- */
  {
    const ENABLE_GATE = true;
    const STORE_KEY   = 'gate-ok';
    const PASSWORD    = '123';
    const TTL_HOURS   = 0;  // 0=期限なし

    // URLに ?unlock=... があればアンロック（必要なければ削除）
    const url = new URL(location.href);
    if (url.searchParams.get('unlock') === PASSWORD) {
      localStorage.setItem(STORE_KEY, JSON.stringify({ok:1, at:Date.now()}));
      history.replaceState(null,'',location.pathname);
    }

    if (ENABLE_GATE) {
      const gate = document.getElementById('gate');
      const form = document.getElementById('gateForm');
      const pw   = document.getElementById('pw');

      const saved = (()=>{ try{return JSON.parse(localStorage.getItem(STORE_KEY)||'');}catch{return null;} })();
      const fresh = saved && saved.ok===1 && (Date.now() - saved.at) < TTL_HOURS*3600*1000;

      const unlock = () => {
        localStorage.setItem(STORE_KEY, JSON.stringify({ok:1, at:Date.now()}));
        gate.remove();
        document.body.classList.remove('locked');
      };

      if (!fresh) {
        gate.classList.remove('hidden');
        document.body.classList.add('locked');
        pw.focus();
        form.addEventListener('submit', (e)=>{
          e.preventDefault();
          if (pw.value.trim() === PASSWORD) unlock();
          else { alert('パスワードが違います'); pw.value=''; pw.focus(); }
        });
      } else {
        gate.remove();
      }
    }
  }
  </script>

  <script>
  // Post-init tweaks: rel, decoding, currency symbols
  {
    // Ensure external links use noopener noreferrer
    document.querySelectorAll('a[target="_blank"]').forEach(a=>{
      const rel = (a.getAttribute('rel')||'').split(/\s+/).filter(Boolean);
      if(!rel.includes('noopener')) rel.push('noopener');
      if(!rel.includes('noreferrer')) rel.push('noreferrer');
      a.setAttribute('rel', rel.join(' '));
    });

    // Add decoding hint to photos grid images
    document.querySelectorAll('#photos .photo-grid img, .menu-photo-grid img').forEach(img=>{
      if(!img.hasAttribute('decoding')) img.setAttribute('decoding','async');
    });

    // Normalize currency: leading backslash -> Yen
    const fixYen = (s)=> s
      .replace(/^\\(?=\d)/, '¥')     // \1000 -> ¥1000
      .replace(/^\+\\(?=\d)/, '+¥'); // +\200 -> +¥200
    document.querySelectorAll('.price-badge, .price-list dd').forEach(el=>{
      el.textContent = fixYen(el.textContent.trim());
    });
  }
  </script>

  <script>
  // Post-fix: ensure Yen and label localization (robust)
  {
    // Fix currency symbols in case previous step didn't run as expected
    document.querySelectorAll('.price-badge, .price-list dd').forEach(el=>{
      const t = (el.textContent||'').trim();
      if(t && t.charCodeAt(0) === 92){ // leading backslash
        el.textContent = '¥' + t.slice(1);
      } else if(t && t[0] === '+' && t.charCodeAt(1) === 92){
        el.textContent = '+¥' + t.slice(2);
      }
    });

    // Localize label text
    const pwLabel2 = document.querySelector('label[for="pw"]');
    if(pwLabel2) pwLabel2.textContent = 'パスワード';
  }
  </script>

</body>
</html>
